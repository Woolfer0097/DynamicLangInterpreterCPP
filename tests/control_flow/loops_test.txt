// Test: Loop Statements
// Tests while loops, for loops, and exit statements

test simple_while_loop() is
    var counter := 0
    var sum := 0
    while counter < 5 loop
        sum := sum + counter
        counter := counter + 1
    end
    assert sum == 10  // 0+1+2+3+4 = 10
    assert counter == 5
end

test while_loop_with_false_condition_initially() is
    var x := 0
    while false loop
        x := 99
    end
    assert x == 0  // loop body should not execute
end

test while_loop_with_complex_condition() is
    var x := 10
    var count := 0
    while x > 0 and count < 3 loop
        x := x - 2
        count := count + 1
    end
    assert x == 4
    assert count == 3
end

test infinite_loop_with_exit() is
    var sum := 0
    var i := 1
    loop
        sum := sum + i
        i := i + 1
        if i > 10 => exit
    end
    assert sum == 55  // 1+2+...+10 = 55
    assert i == 11
end

test for_loop_with_range() is
    var sum := 0
    for i in 1..5 loop
        sum := sum + i
    end
    assert sum == 15  // 1+2+3+4+5 = 15
end

test for_loop_with_range_and_variable() is
    var result := 1
    for i in 1..4 loop
        result := result * 2
    end
    assert result == 16  // 2^4 = 16
end

test for_loop_iterating_over_array() is
    var arr := [10, 20, 30, 40]
    var sum := 0
    for value in arr loop
        sum := sum + value
    end
    assert sum == 100
end

test for_loop_iterating_over_array_with_index_variable() is
    var arr := [2, 4, 6, 8]
    var sum := 0
    for i in arr loop
        sum := sum + i
    end
    assert sum == 20
end

test nested_loops() is
    var result := 0
    for i in 1..3 loop
        for j in 1..2 loop
            result := result + 1
        end
    end
    assert result == 6  // 3 * 2 = 6 iterations
end

test loop_with_break_exit_in_nested_structure() is
    var outer_count := 0
    var inner_count := 0
    for i in 1..5 loop
        outer_count := outer_count + 1
        for j in 1..5 loop
            inner_count := inner_count + 1
            if inner_count >= 3 => exit
        end
    end
    assert outer_count == 5
    assert inner_count == 3
end

test loop_with_variable_scope() is
    var sum := 0
    for i in 1..3 loop
        var temp := i * 2
        sum := sum + temp
    end
    assert sum == 12  // (1*2) + (2*2) + (3*2) = 2+4+6 = 12
    // temp should be out of scope here
end

test multiple_exit_conditions() is
    var count := 0
    var sum := 0
    loop
        count := count + 1
        sum := sum + count
        if count >= 10 => exit
        if sum > 50 => exit
    end
    assert count == 10
    assert sum == 55  // sum reached 55 at count=10
end
