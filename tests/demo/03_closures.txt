// Demo: Closures and Higher-Order Functions
// Showcases lexical scoping and function closures

print "=== Closures Demo ==="

// Simple closure - function captures outer variable
var multiplier := 5
var multiply := func(x) => x * multiplier
print "Closure with multiplier = 5:"
print "  multiply(3) =", multiply(3)
print "  multiply(7) =", multiply(7)

// Factory function - returns a closure
var make_counter := func(start) is
    var count := start
    return func() is
        count := count + 1
        return count
    end
end

var counter1 := make_counter(0)
var counter2 := make_counter(100)

print "Independent counters:"
print "  counter1():", counter1()
print "  counter1():", counter1()
print "  counter2():", counter2()
print "  counter1():", counter1()
print "  counter2():", counter2()

// Higher-order function - function as parameter
var apply_twice := func(f, x) => f(f(x))
var add_ten := func(x) => x + 10
print "Higher-order function:"
print "  apply_twice(add_ten, 5) =", apply_twice(add_ten, 5)

// Function returning function (currying)
var make_adder := func(a) => func(b) => a + b
var add_five := make_adder(5)
var add_three := make_adder(3)
print "Curried functions:"
print "  add_five(10) =", add_five(10)
print "  add_three(7) =", add_three(7)

print "=== Demo Complete ==="

